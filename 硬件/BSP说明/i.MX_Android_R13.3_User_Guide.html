<html><head><title>i.MX Android R13.3 User Guide</title><style type="text/css">ol{margin:0;padding:0}.c7{vertical-align:top;width:80.8pt;border-style:solid;background-color:#cccccc;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c54{vertical-align:top;width:234pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c18{vertical-align:top;width:58.4pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c21{vertical-align:top;width:116.2pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:2.2pt 2.2pt 2.2pt 2.2pt}.c35{vertical-align:top;width:116.2pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:5pt 5pt 5pt 5pt}.c34{vertical-align:top;width:117.1pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c0{padding-left:0pt;line-height:1.15;padding-top:0pt;direction:ltr;margin-left:36pt;padding-bottom:0pt}.c41{vertical-align:top;width:468pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c30{vertical-align:top;width:468pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:2.2pt 2.2pt 2.2pt 2.2pt}.c60{vertical-align:top;width:117.8pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:2.2pt 2.2pt 2.2pt 2.2pt}.c47{vertical-align:top;width:80.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c66{vertical-align:top;width:117.8pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:5pt 5pt 5pt 5pt}.c24{vertical-align:top;width:82pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c68{vertical-align:top;width:258pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c22{vertical-align:top;width:466.2pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c15{vertical-align:top;width:117pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:5pt 5pt 5pt 5pt}.c26{vertical-align:top;width:210pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c45{vertical-align:top;width:117pt;border-style:solid;border-color:#000000;border-width:0.8pt;padding:2.2pt 2.2pt 2.2pt 2.2pt}.c38{vertical-align:top;width:64.8pt;border-style:solid;border-color:#000000;border-width:1pt;padding:5pt 5pt 5pt 5pt}.c5{padding-left:0pt;padding-top:0pt;direction:ltr;margin-left:36pt;padding-bottom:12pt}.c44{list-style-type:disc;margin:0;padding:0}.c20{padding-top:14pt;direction:ltr;padding-bottom:4pt}.c3{padding-top:0pt;direction:ltr;padding-bottom:0pt}.c61{list-style-type:circle;margin:0;padding:0}.c23{padding-top:18pt;direction:ltr;padding-bottom:4pt}.c52{list-style-type:decimal;margin:0;padding:0}.c73{padding-top:24pt;padding-bottom:6pt}.c8{margin-right:7.5pt;margin-left:1.5pt}.c2{margin:5px;border:1px solid black}.c14{direction:ltr;margin-left:36pt}.c16{padding-left:0pt;margin-left:36pt}.c69{max-width:468pt;padding:72pt 72pt 72pt 72pt}.c27{color:inherit;text-decoration:inherit}.c25{padding-left:0pt;margin-left:30pt}.c32{padding-left:0pt;margin-left:72pt}.c48{color:#0000ee;text-decoration:underline}.c12{font-size:11pt;font-family:"Arial"}.c9{line-height:1.15;height:10pt}.c4{color:#1155cc;text-decoration:underline}.c65{height:12pt}.c33{height:0pt}.c58{margin-left:18pt}.c28{background-color:#ffffff}.c62{color:#980000}.c75{font-size:36pt}.c55{margin-left:36pt}.c13{background-color:#cccccc}.c67{height:14pt}.c6{background-color:#999999}.c78{font-family:"Arial"}.c50{margin-left:54pt}.c56{margin-right:4.5pt}.c77{padding-top:18pt}.c46{font-size:11pt}.c64{text-decoration:underline}.c53{text-align:right}.c74{height:18pt}.c63{font-size:18pt}.c1{font-family:"Courier New"}.c43{font-size:14pt}.c17{line-height:1.15}.c42{font-size:12pt}.c72{padding-bottom:10pt}.c29{direction:ltr}.c36{border-collapse:collapse}.c51{padding-bottom:11.2pt}.c59{font-family:"Times New Roman"}.c57{margin-left:4.5pt}.c49{text-indent:36pt}.c19{height:10pt}.c39{padding-bottom:12pt}.c71{color:#000099}.c10{text-align:center}.c31{padding-top:0pt}.c11{font-weight:bold}.c40{margin-right:7.5pt}.c37{font-style:italic}.c70{color:#ff0000}.c76{font-size:24pt}.title{padding-top:24pt;line-height:1.0;text-align:left;color:#000000;font-size:36pt;font-family:"Verdana";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.0;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:10pt;font-family:"Verdana"}p{color:#000000;font-size:10pt;margin:0;font-family:"Verdana"}h1{padding-top:12pt;line-height:1.0;text-align:left;color:#000000;font-size:18pt;font-family:"Verdana";font-weight:bold;padding-bottom:12pt}h2{padding-top:11.2pt;line-height:1.0;text-align:left;color:#000000;font-size:14pt;font-family:"Verdana";font-weight:bold;padding-bottom:11.2pt}h3{padding-top:12pt;line-height:1.0;text-align:left;color:#000000;font-size:12pt;font-family:"Verdana";font-weight:bold;padding-bottom:12pt}h4{padding-top:12.8pt;line-height:1.0;text-align:left;color:#000000;font-size:10pt;font-family:"Verdana";font-weight:bold;padding-bottom:12.8pt}h5{padding-top:12.8pt;line-height:1.0;text-align:left;color:#000000;font-size:8pt;font-family:"Verdana";font-weight:bold;padding-bottom:12.8pt}h6{padding-top:18pt;line-height:1.0;text-align:left;color:#000000;font-size:8pt;font-family:"Verdana";font-weight:bold;padding-bottom:18pt}
.auto-style1 {
	font-family: "Courier New", Courier, monospace;
}
.auto-style2 {
	border-collapse: collapse;
	font-size: 10.0pt;
	font-family: "Times New Roman", serif;
}
</style></head><body class="c28 c69"><h1 class="c53 c29"><a name="h.3z6sj2l63aof"></a><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></h1><p class="c3 c19"><span></span></p><h1 class="c53 c29 c74"><a name="h.4p7n8zimqu08"></a></h1><h1 class="c29 c53"><a name="h.rr63t7qpyhhw"></a><span class="c75">i.MX Android </span></h1><h1 class="c53 c29 c49"><a name="h.337b941ef722"></a><span class="c76">User Guide</span></h1><h3 class="c53 c29 c31 c65"><a name="h.6y76f2yu7smt"></a></h3><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c53 c29 c31"><span class="c43">R13.3 </span></p><p class="c56 c53 c29 c31 c57"><span class="c43">May 
30, 2012</span></p><p class="c3"><span>&nbsp;</span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c9"><span></span></p><p class="c3 c17"><span class="c11">This document is a guide on how to use the Android release package. It describes how to setup the environment to apply i.MX android patches and build the entire android system. It also describes how to download built out images into storage device and setup the correct hardware/software boot configurations to boot up system. Meanwhile, it provides the information on how to get Android source from Google, and what the device storage usage and boot option is.</span></p><p class="c3 c9"><span></span></p><p class="c3 c17"><span class="c46 c11">Index</span></p><p><span></span></p><p class="c58 c29"><span class="c4"><a class="c27" href="#h.rr63t7qpyhhw">i.MX Android</a></span></p><p class="c58 c29"><span class="c4"><a class="c27" href="#h.337b941ef722">User Guide</a></span></p><p class="c29 c58"><span class="c4"><a class="c27" href="#h.7e1d09e9e460">1. Preparation</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.1fcadcc79fd6">1.1 PC Setup</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.69b684033f1a">1.2 Unpack i.MX Android Release Package</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.3d926cc11ea1">1.3 Run Android with Prebuilt Image</a></span></p><p class="c58 c29"><span class="c4"><a class="c27" href="#h.bz248h5rkqyb">2. Build Android for i.MX</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.1bb5fb9f86bf">2.1 Get Android Source Code (Android/Kernel/uboot)</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.1204bc6dfa9d">2.2 Patch Code for i.MX</a></span></p>
<p class="c14"><span class="c4"><a class="c27" href="#h.ade9b591a047">2.3 Build Uboot Images</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.f699aef63d2a">2.4 Build Kernel Image</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.b37911dc8518">2.5 Build Android Image</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.4c8bdd18ca1f">2.5.1 User Build mode</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.89ebequo2sle">2.6 Build boot.img</a></span></p><p class="c58 c29"><span class="c4"><a class="c27" href="#h.839b6152b65f">3. Download Images</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.b4g9o7rp3kzf">3.1 System on MMC/SD</a></span></p><p class="c29 c50"><span class="c4"><a class="c27" href="#h.kk99rpb2mwdf">3.1.1 Storage Partitions</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.e7ewd27hrybo">3.1.2 Download Images with MFG Tool</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.5ld6crm1mpu6">3.1.3 Download Images with dd utility</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.3db716197dfd">3.2 System on NFS</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.j4tyo9h2u8of">3.2.1 Setup the TFTP and NFS root</a></span></p><p class="c58 c29"><span class="c4"><a class="c27" href="#h.q28ksz5s8d8c">4. Bootup</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.f5orimm44ev2">4.1 Boot from MMC/SD</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.r34df2lwgb4i">4.2 Boot from TFTP and NFS</a></span></p><p class="c14"><span class="c4"><a class="c27" href="#h.08f97735ad8d">4.3 Boot Up configurations</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.88ff68d3f7be">4.3.1 U-Boot environment</a></span></p><p class="c50 c29"><span class="c4"><a class="c27" href="#h.e7ddf79061b9">4.3.2 Kernel command line (bootargs)</a></span></p><p class="c29 c19 c39 c31"><span></span></p><p class="c29 c19 c31 c39"><span></span></p><p class="c29 c19 c39 c31"><span class="c48"><a class="c27" href="#b.80"></a></span></p><h1 class="c29 c31"><a name="h.7e1d09e9e460"></a><span class="c11">1. </span><span>Preparation</span></h1><h2 class="c29 c31"><a name="h.1fcadcc79fd6"></a><span>1.1 </span><span class="c11 c43">PC Setup</span></h2><p class="c29"><span>To build the Android source files, you will need to use Linux PC. It is suggested that you use the 10.10 or 11.04 64bit version of Ubuntu which are the most tested OS for the Android 4.0.4 build.</span></p><p class="c3"><span>After installing Linux PC, you need to check whether you have all the necessary packages installed for an Android build. Refer to &quot;Setting up your machine&quot; on the Android web site </span><span class="c12 c4"><a class="c27" href="http://source.android.com/source/initializing.html">http://source.android.com/source/initializing.html</a></span><span>.</span><span>&nbsp;</span></p><p class="c29 c51 c31"><span>&nbsp;</span></p><h2 class="c29 c31"><a name="h.69b684033f1a"></a><span class="c43 c11">1.2 Unpack i.MX Android Release Package</span></h2><p class="c3"><span>After you setup a Linux PC, unpack the FSL i.MX Android Release Package using the following commands:&nbsp;</span></p><a href="#" name="29dc927ab1cc04ad68ba1a6875af6f226fa7de98"></a><a href="#" name="0"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">$ cd /opt (or any other directory you like)&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ tar xzvf imx-android-r13.3.tar.gz&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ cd imx-android-r13.3/code&nbsp;&nbsp;&nbsp;</span></p><p class="c3"><span class="c1">$ tar xzvf r13.3.tar.gz</span></p></td></tr></tbody></table><p class="c29 c51 c31"><span>&nbsp;</span></p><h2 class="c29 c31"><a name="h.3d926cc11ea1"></a><span>1.3 Run Android with Prebuilt Image</span></h2><p class="c29"><span>To test Android before building any code, use the prebuilt images under image/ and directly go to &quot;Download Images and Bootup&quot;.</span></p><p class="c3"><span>The prebuilt image is under each platform directory that is uncompressed from the release package:</span></p><p class="c3 c19"><span></span></p><p class="c3"><span class="c11">For i.MX6Q SabreSD platform:</span></p><p class="c3 c19"><span></span></p><ol class="c44" start="1"><li class="c3 c16"><span class="c11">Uboot image</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>bootloader: sabresd_6q/u-boot-no-padding.bin or sabresd_6q/u-boot.bin (with padding)</span></li></ol><ol class="c44" start="2"><li class="c3 c16"><span class="c11">Boot image</span></li></ol><ol class="c61" start="1"><li class="c3 c32 c17"><span>sabresd_6q/eMMC/boot.img: boot.img is an android image that stores zImage and ramdisk together. It can also store some other information like the kernel boot command line, machine name, e.g. It can fully configure in android android.mk, so we don&#39;t need to touch boot loader code to change any default boot args.</span></li></ol><p class="c3 c55 c17"><span class="c11">Notes:</span></p><p class="c3 c55 c17"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If you use boot.img, you don&rsquo;t need Image and uramdisk.img; boot.img will include them.</span></p><ol class="c44" start="3"><li class="c3 c16"><span class="c11">Android system images for eMMC card</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>System root: &nbsp;sabresd_6q/eMMC/system.img</span></li><li class="c3 c32"><span>Data: sabresd_6q/eMMC/userdata.img. Not provided since it&#39;s empty.</span></li><li class="c3 c32"><span>Boot image:sabresd_6q/eMMC/boot.img</span></li><li class="c3 c32"><span>Recovery image: sabresd_6q/eMMC/recovery.img</span></li></ol><ol class="c44" start="4"><li class="c3 c16"><span class="c11">Android system images for TFTP/NFS</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>sabresd_6q</span><span>/NFS/android_fs.tar.gz</span></li></ol><ol class="c44" start="5"><li class="c3 c16"><span class="c11">Kernel image for TFTP/NFS</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>sabresd_6q/NFS/uImage</span></li></ol><p class="c3 c19 c55"><span></span></p><p class="c3"><span class="c11">For i.MX6DL SabreSD platform:</span></p><p class="c3 c19"><span></span></p><ol class="c44" start="6"><li class="c3 c16"><span class="c11">Uboot image</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>bootloader: sabresd_6dl/u-boot-no-padding.bin or sabresd_6dl/u-boot.bin (with padding)</span></li></ol><ol class="c44" start="7"><li class="c3 c16"><span class="c11">Boot image</span></li></ol><ol class="c61" start="1"><li class="c3 c32 c17"><span>sabresd_6dl/eMMC/boot.img: boot.img is an android image that stores </span><span>zImage and ramdisk together. It can also store some other information like the kernel boot command line, machine name, e.g. It can fully configure in android android.mk, so we don&#39;t need to touch boot loader code to change any default boot args.</span></li></ol><p class="c3 c55 c17"><span class="c11">Notes:</span></p><p class="c3 c55 c17"><span class="c11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If you use boot.img, you don&rsquo;t need use uImage and uramdisk.img; boot.img will include them.</span></p><ol class="c44" start="8"><li class="c3 c16"><span class="c11">Android system images for eMMC card</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>System root: &nbsp;sabresd_6dl/eMMC/system.img</span></li><li class="c3 c32"><span>Data: sabresd_6dl/eMMC/userdata.img. Not provided since it&#39;s empty.</span></li><li class="c3 c32"><span>Boot image:sabresd_6dl/eMMC/boot.img</span></li><li class="c3 c32"><span>Recovery image: sabresd_6dl/eMMC/recovery.img</span></li></ol><ol class="c44" start="9"><li class="c3 c16"><span class="c11">Android system images for TFTP/NFS</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>sabresd_6dl/NFS/android_fs.tar.gz</span></li></ol><ol class="c44" start="10"><li class="c3 c16"><span class="c11">Kernel image for TFTP/NFS</span></li></ol><ol class="c61" start="1"><li class="c3 c32"><span>sabresd_6dl/NFS/uImage</span></li></ol><p class="c3 c19"><span></span></p><h1 class="c29"><a name="h.bz248h5rkqyb"></a><span class="c63 c11">2. Build Android for i.MX</span></h1><p class="c3 c19"><span></span></p><h2 class="c29 c31"><a name="h.1bb5fb9f86bf"></a><span>2.1 Get Android Source Code (Android/Kernel/uboot)</span></h2><p class="c29"><span>The Android source code is maintained as more than 100 gits in an Android repository (android.googlesource.com).</span></p><p class="c3"><span>To get the Android source code from Google repo, follow the steps:&nbsp;</span></p><a href="#" name="948b79d04a13ceceed9cc65f2a00c6537b603c6e"></a><a href="#" name="1"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">Assume you had unzipped i.MX Android release package to /opt/imx-android-r13.3/.</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ 
$ cd ~ </span></p>
<p class="c3 c8"><span class="c1">$ mkdir myandroid </span></p>
<p class="c3 c8"><span class="c1">$ cd myandroid </span></p>
<p class="c3 c8"><span class="c1">$ curl 
https://dl-ssl.google.com/dl/googlesource/git-repo/repo &gt; ./repo </span></p>
<p class="c3 c8"><span class="c1">$ chmod a+x ./repo </span></p>
<p class="c3 c19 c40"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ 
./repo init -u </span><span class="c64 c1 c71"><a class="c27" href="https://android.googlesource.com/platform/manifest">https://android.googlesource.com/platform/manifest</a></span><span class="c1">&nbsp;-b android-4.0.4_r1.1</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ cp /opt/imx-android-r13.3/code/r13.3/default.xml .repo/manifests/default.xml&nbsp;</span></p><p class="c3 c8"><span class="c1">(To avoid loading unnecessary gits from Google repo, meanwhile load some gits from Google repo which is not included in default manifest)</span></p><p class="c3 c8"><span class="c1">$ ./repo sync</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c17"><span class="c13 c1">after sync code successfully,do the following:</span></p><p class="c3 c17"><span class="c13 c1">$</span><span class="c13 c1">&nbsp;cd myandroid/external</span></p><p class="c3 c17"><span class="c13 c1">$</span><span class="c1 c13">&nbsp;git clone </span><span class="c13 c64 c1"><a class="c27" href="">git://android.git.linaro.org/platform/external/alsa-lib.git</a></span></p><p class="c3 c9"><span class="c13 c1"></span></p><p class="c3 c17"><span class="c13 c1">$ cd myandroid/external</span></p><p class="c3 c17"><span class="c13 c1">$ git clone </span><span class="c13 c1 c64"><a class="c27" href="">git://android.git.linaro.org/platform/external/alsa-utils.git</a></span></p><p class="c3 c9"><span class="c13 c1"></span></p><p class="c3 c17"><span class="c13 c1">$</span><span class="c13 c1">&nbsp;cd myandroid/hardware</span></p><p class="c3 c17"><span class="c13 c1">$</span><span class="c13 c1">&nbsp;git clone </span><span class="c13 c64 c1 c71"><a class="c27" href="">git://android.git.linaro.org/platform/hardware/alsa_sound.git</a></span></p><p class="c3 c19 c40"><span class="c1"></span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3"><span>Get R13.3 kernel source code from freescale&rsquo;s opensource git:</span></p><a href="#" name="04f13d4594dedff30918a3e70e4c0c04fec9cdfa"></a><a href="#" name="2"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">$ cd myandroid&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ git clone </span><span class="c4 c1"><a class="c27" href="">git://git.freescale.com/imx/linux-2.6-imx.git</a></span><span class="c1">&nbsp;kernel_imx</span></p><p class="c3 c8"><span class="c1">$ cd kernel_imx</span></p><p class="c3 c8"><span class="c1">$ git checkout imx-android-r13.3</span></p></td></tr></tbody></table><p class="c3"><span>&nbsp;</span></p><p class="c3"><span class="c11">NOTE: If you&rsquo;re behind proxy, please use socksify to set socks proxy for git protocol.</span></p><p class="c3 c19"><span class="c11"></span></p><p class="c3"><span>If you use uboot as your bootloader, then you can clone the uboot git repository from freescale&rsquo;s opensource git:</span></p><a href="#" name="73c0e7c42b2c3e69d8889844ec6deda833cdc3ec"></a><a href="#" name="3"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c8 c29"><span class="c1">$ cd myandroid/bootable/bootloader</span></p><p class="c3 c8"><span class="c1">$ git clone </span><span class="c4 c1"><a class="c27" href="">git://git.freescale.com/imx/uboot-imx.git</a></span><span class="c1">&nbsp;uboot-imx</span></p><p class="c3 c8"><span class="c1">$ cd uboot-imx</span></p><p class="c3 c8"><span class="c1">$ git checkout imx-android-r13.3</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c29 c51 c19 c31"><span></span></p><h2 class="c29 c31"><a name="h.1204bc6dfa9d"></a><span>2.2 Patch Code for i.MX&nbsp;</span></h2><p class="c3"><span>Apply all i.MX Android patches using the following steps:</span></p><p class="c3 c19"><span></span></p><a href="#" name="d9a9b94b0c5866365f69edff0625a2152f188bba"></a><a href="#" name="4"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">
Assume you had unzipped i.MX Android release package to /opt/imx-android-r13.3/ 
and the user account used to run the following commands have write access to the 
folder&nbsp; &nbsp;</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ cd ~/myandroid&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ . /opt/imx-android-r13.3/code/r13.3/and_patch.sh&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ help&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">Now you should see &quot;c_patch&quot; function is available for you&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ c_patch /opt/imx-android-r13.3/code/r13.3 imx_r13.3&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">Here &quot;/opt/imx-android-r13.3/code/r13.3&quot; is the location of the patches (i.e. directory created when you unzip release package)&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">&quot;imx_r13.3&quot; is the branch which will be created automatically for you to hold all patches (only in those existing Google gits). &nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">You can choose any branch name you like instead of &quot;imx_r13.3&quot;.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c40"><span class="c1">If everything is OK, &quot;c_patch&quot; will generate the following output to indicate successful patch:&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">**************************************************************&nbsp;&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">Success: Now you can build android code for FSL i.MX platform&nbsp;&nbsp;&nbsp;</span></p><p class="c3"><span class="c1">**************************************************************</span></p></td></tr></tbody></table><p class="c29 c51 c31"><span class="c11">Notes:</span><span>&nbsp;The patch script (and_patch.sh) </span><span>requires</span><span>&nbsp;some basic utilities like awk/sed. If they are not available on your </span><span>Linux PC,</span><span>&nbsp;install them in advance.</span></p><h2 class="c29 c31"><a name="h.b37911dc8518"></a></h2>
<p class="c29 c19 c39 c31">&nbsp;</p><h2 class="c29 c31"><a name="h.ade9b591a047"></a><span>2.3 Build Uboot Images</span></h2>
<a href="#" name="122c6b200d3f69260c3184cbd2fb1655ff91626d"></a><a href="#" name="8"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">$ cd ~/myandroid/bootable/bootloader/uboot-imx</span></p><p class="c3 c8"><span class="c1">$ export ARCH=arm</span></p>
	<p class="auto-style1">$ export 
	CROSS_COMPILE=~/myandroid/prebuilt/linux-x86/toolchain/arm-eabi-4.4.3/bin/arm-eabi- </p><p class="c3 c8"><span>&nbsp;</span><span class="c1">Command to build for i.MX6Q SabreSD or i.MX6DL SabreSD board is:</span></p><p class="c3 c8"><span class="c1">$ make distclean</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1 c11">For i.MX6Q SabreSD:</span></p><p class="c3 c8"><span class="c1">$ make mx6q_sabresd_android_config</span></p><p class="c3 c8"><span class="c1 c11">For i.MX6DL SabreSD:</span></p><p class="c3 c8"><span class="c1">$ make mx6dl_sabresd_android_config</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ make</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">&quot;u-boot.bin&quot; is generated if you have a successful build.</span></p><p class="c3 c8"><span class="c1">The above u-boot.bin has 1024KB padding at the head of the file,for example: first executable instruction is at the offset 1KB. If you want to generate a no-padding image, you need to implement the dd command specified below in host.</span></p><p class="c3 c8"><span class="c1">$ sudo dd if=./u-boot.bin of=./u-boot-no-padding.bin bs=1024 skip=1; sync</span></p><p class="c3 c8"><span class="c1">Usually the no-padding uboot image is used in the SD card, for example, program the no-padding uboot image into 1KB offset of SD card so that you do not overwrite the MBR (including partition table) within first 512B on the SD card.</span></p><p class="c3"><span>&nbsp;</span></p><p class="c3 c40"><span class="c1 c11">Note</span><span class="c1">:&nbsp;</span></p><p class="c3 c40"><span class="c1">Any image which should be loaded by uBoot must have an unique image head, for example, some data must be added at the head of the loaded image to tell uboot about the image (i.e., it&#39;s a kernel, or ramfs, etc) and how to load the image (i.e., load/execute address).Before you can load any image into RAM by uboot, you need a tool to add this information and generate a new image which can be recognized by uboot. Fortunately, this tool is delivered together with uboot. After you set up uboot using the steps above, you can find the tool (mkimage) under tools/. The process of how to use mkimage for generating the image (for example kernel image, ramfs image), which is to be loaded by uboot, is outlined in the subsequent sections of this document.&nbsp;</span></p></td></tr></tbody></table><h2 class="c29 c67"><a name="h.ngf5wxlgjtt6"></a></h2><h2 class="c29"><a name="h.f699aef63d2a"></a><span>2.4 Build Kernel Image</span></h2><p class="c29"><span>Kernel image will be built out when building the android root file system. If you do not need to build the kernel image, you can skip to the next section. </span></p><p class="c3"><span>To run Android using NFS or from SD, build the kernel with the default&nbsp;configuration&nbsp;as described below:</span></p><a href="#" name="49a5f56c6749efeba2876babd26dea19edf8e2f8"></a><a href="#" name="9"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">Assume you had already built uboot. mkimage was generated under myandroid/bootable/bootloader/uboot-imx/tools/ and it&#39;s in your PATH</span></p><p class="c3 c8"><span class="c1">$ export PATH=~/myandroid/bootable/bootloader/uboot-imx/tools:$PATH</span></p><p class="c3 c8"><span class="c1">$ cd ~/myandroid/kernel_imx</span></p><p class="c3 c8"><span class="c1">$ echo $ARCH &amp;&amp; echo $CROSS_COMPILE</span></p><p class="c3 c8"><span class="c1">Make sure you have those 2 environment variables set</span></p><p class="c3 c8"><span class="c1">If the two variables have not set, please set the as:</span></p><p class="c3 c8"><span class="c1">$ </span><span class="c13 c1">export ARCH=arm</span></p><p class="c3 c8"><span class="c1">$ export CROSS_COMPILE=~/myandroid/prebuilt/linux-x86/toolchain/arm-eabi-4.4.3/bin/arm-eabi-</span></p><p class="c3 c8"><span class="c1">$ make imx6_android_defconfig</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">Generate &quot;.</span></p><p class="c3 c8"><span class="c1">config&quot; according to default config file under arch/arm/configs.</span></p><p class="c3 c8"><span class="c1">$ make uImage</span></p></td></tr></tbody></table><p class="c3"><span>&nbsp;</span></p><p class="c3"><span>With a successful build in either of the above case, the generated kernel image is ~/myandroid/kernel_imx/arch/arm/boot/uImage.</span></p><h2 class="c23"><a name="h.89ebequo2sle"></a></h2>
<h2 class="c29 c31"><span>2.5 Build Android Image&nbsp;</span></h2>
<p class="MsoNormal"><b>
<span style="font-family:&quot;Verdana&quot;,&quot;sans-serif&quot;;color:black">
Note:</span></b><span style="font-size:13.5pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;;color:black"><o:p></o:p></span></p>
<p class="MsoNormal"><![if !supportLists]>
<span style="font-family:Symbol;mso-fareast-font-family:Symbol;mso-bidi-font-family:
Symbol;color:black"><span style="mso-list:Ignore">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><![endif]>
<span style="font-family:&quot;Verdana&quot;,&quot;sans-serif&quot;;
color:black">Make sure the mkimage is a valid commands in your build machine. If 
not, please follow the below commands to have it installed:<o:p></o:p></span></p>
<table border="0" cellpadding="0" cellspacing="0" class="auto-style2" style="width: 6.5in; mso-yfti-tbllook: 1184; mso-padding-alt: 0in 0in 0in 0in" width="624">
	<tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;mso-yfti-lastrow:yes">
		<td style="border: solid black 1.0pt; background: #CCCCCC; padding: 5.25pt 5.25pt 5.25pt 5.25pt" valign="top">
		<p class="MsoNormal">
		<span style="font-family:&quot;Courier New&quot;;color:black">$sudo 
		apt-get install uboot-mkimage</span><span style="font-size:12.0pt;font-family:&quot;Times New Roman&quot;,&quot;serif&quot;"><o:p></o:p></span></p>
		</td>
	</tr>
</table>
<p class="c3">&nbsp;</p>
<p class="c3">&nbsp;</p>
<p class="c3"><span>After applying all i.MX patches, build the uboot, kernel, and Android image using the following steps:</span></p><a href="#" name="444be4ad981ab08c88f8037149300f9fabfe75f1"></a><a href="#" name="5"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3 c8"><span class="c1">$ cd ~/myandroid&nbsp;&nbsp;</span></p><p class="c3 c8"><span class="c1">$ source build/envsetup.sh</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">For SabreSD i.MX6Q platform:</span></p><p class="c3 c8"><span class="c1">$ lunch </span><span class="c1">sabresd_6q</span><span class="c1">-user</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">For SabreSD i.MX6DL platform:</span></p><p class="c3 c8"><span class="c1">$ lunch sabresd_6dl-user</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">$ make</span></p><p class="c3 c8 c19"><span class="c1"></span></p><p class="c3 c8"><span class="c1">&quot;</span><span class="c1">sabresd_6q</span><span class="c1">/</span><span class="c1">sabresd_6dl</span><span class="c1">&quot; is the product names (see ~/myandroid/device/fsl/product)</span></p><p class="c3 c8"><span class="c1">After build, check build_*_android.log to make sure no build error.</span></p></td></tr></tbody></table><p class="c3"><span>&nbsp;</span></p><p class="c3"><span>For i.MX6Q SabreSD</span><span>&nbsp;and i.MX6DL </span><span>build, the following outputs are generated as default under myandroid/out/target/product/sabresd_6q</span><span>&nbsp;and &nbsp;myandroid/out/target/product/sabresd_6dl:</span></p><ol class="c44" start="1"><li class="c3 c16"><span class="c11">root/</span><span>&nbsp;: root file system (including init, init.rc, etc). Mounted at </span><span class="c11">/</span></li><li class="c3 c16"><span class="c11">system/</span><span>: &nbsp;Android system binary/libraries. Mounted at </span><span class="c11">/system</span></li><li class="c3 c16"><span class="c11">data/</span><span>: Android data area. Mounted at </span><span class="c11">/data</span></li><li class="c3 c16"><span class="c11">recovery/</span><span>: root file system when booting in &quot;recovery&quot; mode. Not used directly.</span></li><li class="c3 c16"><span class="c11">boot.img</span><span>: a composite image which includes the kernel zImage, ramdisk, and boot parameters. </span></li><li class="c3 c16"><span class="c11">ramdisk.img</span><span>: Ramdisk image generated from &quot;root/&quot;. Not directly used.</span></li><li class="c3 c16"><span class="c11">system.img:</span><span>&nbsp;EXT4 image generated from &quot;system/&quot;. Can be programmed to &quot;SYSTEM&quot; partition on SD/eMMC card with &quot;dd&quot;</span></li><li class="c3 c16"><span class="c11">userdata.img:</span><span>&nbsp;EXT4 image generated from &quot;data/&quot;.</span></li><li class="c5"><span class="c11">recovery.img:</span><span>&nbsp;EXT4 image generated from &quot;recovery/&quot;. Can be programmed to &quot;RECOVERY&quot; partition on SD/eMMC card with &quot;dd&quot;</span></li><li class="c5"><span class="c11">u-boot.bin:</span><span>&nbsp;uboot image with padding.</span></li></ol><p class="c29 c39 c31"><span class="c11">Note:</span></p><ol class="c44" start="1"><li class="c5"><span>To build the uboot image separately, please refer to the section 2.4</span></li><li class="c5"><span>To build the kernel uImage separately, please refer to the section 2.5</span></li><li class="c5"><span>To build boot.img, please refer to the section 2.6</span></li></ol><p class="c29 c19 c39 c31"><span class="c11"></span></p><h3 class="c29 c31"><a name="h.4c8bdd18ca1f"></a><span class="c42 c11">2.5</span><span class="c42 c11">.1 User Build mode</span></h3><p class="c3"><span>For production release, the android image should be built in user mode. When compared to eng mode, it will have the following differences:</span></p><ol class="c44" start="1"><li class="c3 c16"><span>it will have limited access due to security reason, and it will lack many debug tools.</span></li><li class="c3 c16"><span>It will install modules tagged with </span><span class="c37">user, and those</span><span>l APKs&amp;tools according to product definition files, which is in </span><span class="c11">PRODUCT_PACKAGES</span><span>&nbsp;in </span><span class="c11">device/fsl/imx6/imx6.mk</span></li><li class="c3 c16"><span>S</span><span>et ro.secure=1, and ro.debuggable=0, and adb is disabled by default.&nbsp;</span></li></ol><p class="c3"><span>If you need to add your customized package, please add the package&#39;s MODULES_NAME or PACKAGE_NAME to this list.</span></p><p class="c3"><span>&nbsp;</span></p><p class="c3"><span>Change the </span><span class="c37">eng</span><span>&nbsp;in the previous section to </span><span class="c37">user</span><span>&nbsp;to generate user mode image:</span></p><p class="c3"><span>eg:</span></p><p class="c3"><span>&nbsp;</span></p><a href="#" name="334574c318cb432479f448f4eb5010175ae80464"></a><a href="#" name="6"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">$ make PRODUCT-</span><span class="c1">sabresd_6q</span><span class="c1">-user 2&gt;&amp;1 | tee build_</span><span class="c1">sabresd_6q</span><span class="c1">_android.log</span></p></td></tr></tbody></table><p class="c3"><span>Or you can use the following commands:</span></p><p class="c3"><span>&nbsp;</span></p><a href="#" name="080f8d80444f6c50f4123b2734933c4e70be52e9"></a><a href="#" name="7"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">$ . build/envsetup</span></p><p class="c3"><span class="c1">$ lunch </span><span class="c1">sabresd_6q</span><span class="c1">-user</span></p><p class="c3"><span class="c1">$ make</span></p><p class="c3"><span class="c1">$ make dist # you can generate ota package with this command.</span></p></td></tr></tbody></table><p class="c3"><span>For m</span><span>ore android building information please refer to: </span><span class="c48"><a class="c27" href="http://source.android.com/source/building.html">http://source.android.com/source/building.html</a></span></p><p class="c3"><span class="c11">&nbsp;&nbsp;</span></p><p class="c3"><span>&nbsp;</span></p>
<h2 class="c23"><span>2.6 Build boot.img </span></h2><p class="c3 c19"><span></span></p><p class="c3"><span>As outlined in Section 1.3, we use boot.img and booti as default commands to boot rather than the uramdisk and uImage we used before.</span></p><p class="c3 c19"><span></span></p><p class="c3"><span>You can use this command to generate boot.img under android environment:</span></p><p class="c3 c19"><span></span></p><a href="#" name="8e3c3283e7515fd589a5d14681507cf0714dcc2c"></a><a href="#" name="10"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">$ 
	source build/envsetup.sh</span></p><p class="c3"><span class="c1">$ lunch sabresd_6q-user</span></p><p class="c3"><span class="c1">$ make bootimage</span></p></td></tr></tbody></table><p class="c3"><span>&nbsp;</span></p><p class="c3 c19"><span></span></p><h1 class="c29 c31"><a name="h.839b6152b65f"></a><span>3. Download Images</span></h1><p class="c3"><span>i.MX Android can be booted up in two ways:</span></p><ol class="c52" start="1"><li class="c3 c16"><span>Boot from MMC/SD</span></li><li class="c3 c16"><span>Boot from NFS (networking)</span></li></ol><p class="c3 c19"><span></span></p><p class="c3"><span>Before boot, you should program the bootloader, kernel, ramdisk and rootfs images into the main storage device (MMC/SD or TF) or unpack the NFS root filesystem into the NFS server root.</span></p><p class="c3 c19"><span></span></p><p class="c3"><span>The following download methods are supported for i.MX6Q SabreSD and i.MX6DL platforms:</span></p><ol class="c44" start="1"><li class="c3 c16"><span>MFGTool to download all images to MMC/SD card</span></li><li class="c3 c16"><span>Using dd command to download all images to MMC/SD card</span></li></ol><h2 class="c17 c23"><a name="h.b4g9o7rp3kzf"></a><span>3.1 System on MMC/SD</span></h2><p class="c3 c17"><span>The i</span><span>mages needed to create an android system on MMC/SD</span><span>&nbsp;are listed below</span><span>:</span></p><ol class="c44" start="1"><li class="c0"><span>u-boot image: u-boot.bin or u-boot-no-padding.bin </span></li><li class="c0"><span>boot image: boot.img</span></li><li class="c0"><span>Android system root image: system.img</span></li><li class="c0"><span>Recovery root image: recovery.img</span></li></ol><p class="c3 c17"><span>The images can be obtained from the release package or they can be built out.</span></p><h3 class="c20 c17"><a name="h.kk99rpb2mwdf"></a><span>3.1.1 Storage Partitions</span></h3><p class="c3 c17"><span>The layout of the MMC/SD/TF card for Android system is shown below:</span></p><ol class="c44" start="1"><li class="c0"><span>[Partition type/index] is which defined in the MBR. </span></li><li class="c0"><span>[Name] is only meaningful in android. You can ignore it when creating these partitions.</span></li><li class="c0"><span>[Start Offset] shows where partition is started, unit in MB.</span></li></ol><p class="c3 c9"><span></span></p><p class="c3"><span>T</span><span>he SYST</span><span>EM partition is used to put the built out android system image. The DATA is used to put applications&rsquo; unpacked codes/data, system configuration database, etc. In normal boot mode, the root file system is mounted from uramdisk. In recovery mode, the root file system is mounted from the RECOVERY partition.</span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3 c9"><span class="c12"></span></p><a href="#" name="5caa94742f91ee2a837bd4b0e7bab60442ac3cf8"></a><a href="#" name="11"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c24 c13"><p class="c3 c17 c10"><span class="c11">Partition Type/Index</span></p></td><td class="c7"><p class="c3 c17 c10"><span class="c11">Name</span></p></td><td class="c38 c13"><p class="c3 c17 c10"><span class="c11">Start Offset</span></p></td><td class="c18 c13"><p class="c3 c17 c10"><span class="c11">Size</span></p></td><td class="c38 c13"><p class="c3 c17 c10"><span class="c11">File System</span></p></td><td class="c34 c13"><p class="c3 c17 c10"><span class="c11">Content</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>N/A</span></p></td><td class="c47"><p class="c3 c17 c10"><span>BOOT Loader</span></p></td><td class="c38"><p class="c3 c17 c10"><span>0</span></p></td><td class="c18"><p class="c3 c17 c10"><span>1MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>N/A</span></p></td><td class="c34"><p class="c3 c17 c10"><span>bootloader</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>Primary 1</span></p></td><td class="c47"><p class="c3 c17 c10"><span>Boot</span></p></td><td class="c38"><p class="c3 c17 c10"><span>8M</span></p></td><td class="c18"><p class="c3 c17 c10"><span>8MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>boot.img format, a kernel + ramdisk</span></p></td><td class="c34"><p class="c3 c17 c10"><span>boot.img</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>Primary 2</span></p></td><td class="c47"><p class="c3 c17 c10"><span>Recovery</span></p></td><td class="c38"><p class="c3 c17 c10"><span>Follow Boot</span></p></td><td class="c18"><p class="c3 c17 c10"><span>8MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>boot.img format, a kernel + ramdisk</span></p></td><td class="c34"><p class="c3 c17 c10"><span>recovery.img</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>Logic 5 (Extended 3)</span></p></td><td class="c47"><p class="c3 c17 c10"><span>SYSTEM</span></p></td><td class="c38"><p class="c3 c17 c10"><span>Follow Recovery</span></p></td><td class="c18"><p class="c3 c17 c10"><span>512MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>EXT4. Mount as /system</span></p></td><td class="c34"><p class="c3 c17 c10"><span>Android system files under /system/ dir</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>Logic 6 (Extended 3)</span></p></td><td class="c47"><p class="c3 c17 c10"><span>CACHE</span></p></td><td class="c38"><p class="c3 c17 c10"><span>follow SYSTEM</span></p></td><td class="c18"><p class="c3 c17 c10"><span>256MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>EXT4. Mount as /cache</span></p></td><td class="c34"><p class="c3 c17 c10"><span>Android cache, for image store for OTA</span></p></td></tr><tr class="c33"><td class="c24"><p class="c3 c17 c10"><span>Logic 7</span></p><p class="c3 c17 c10"><span>(Extended 3)</span></p></td><td class="c47"><p class="c3 c17 c10"><span>DATA</span></p></td><td class="c38"><p class="c3 c17 c10"><span>follow CACHE</span></p></td><td class="c18"><p class="c3 c10 c17"><span>&gt; 1024MB</span></p></td><td class="c38"><p class="c3 c17 c10"><span>EXT4. Mount at /data</span></p></td><td class="c34"><p class="c3 c17 c10"><span>Application data storage for system application.</span></p></td></tr><tr><td class="c24"><p class="c3 c17 c10"><span>Logic 8</span></p><p class="c3 c17 c10"><span>(Extended 3)</span></p></td><td class="c47"><p class="c3 c10"><span>Vendor</span></p></td><td class="c38"><p class="c3"><span>follow DATA</span></p></td><td class="c18"><p class="c3"><span>&nbsp; 8MB</span></p></td><td class="c38"><p class="c3"><span>Ext4.</span></p><p class="c3"><span>Mount at /vender</span></p></td><td class="c34"><p class="c3"><span>For Store MAC address files.</span></p></td></tr><tr><td class="c24"><p class="c3"><span>Logic 9</span></p><p class="c3"><span>(Extended 3)</span></p></td><td class="c47"><p class="c3"><span>Misc</span></p></td><td class="c38"><p class="c3"><span>Follow</span></p><p class="c3"><span>DATA</span></p></td><td class="c18"><p class="c3"><span>4M</span></p></td><td class="c38"><p class="c3"><span>N/A</span></p></td><td class="c34"><p class="c3"><span>For recovery store bootloader message, reserve.</span></p></td></tr><tr><td class="c24"><p class="c3"><span>Primary 4</span></p></td><td class="c47"><p class="c3"><span>MEDIA</span></p></td><td class="c38"><p class="c3"><span>Follow Misc</span></p></td><td class="c18"><p class="c3"><span>Total - Other images</span></p></td><td class="c38"><p class="c3"><span>VFAT</span></p></td><td class="c34"><p class="c3"><span>For internal media partition, in /mnt/sdcard/ dir.</span></p></td></tr></tbody></table><p class="c3 c9"><span></span></p><p class="c3"><span>To create these partitions, you can use MFGTool described in the &ldquo;Quick Start&rdquo; doc, or use format tools in prebuild dir..</span></p><p class="c3"><span>The script below can be used to partition a sdcard as shown in the partition table above:</span></p><a href="#" name="4a74f648ecc0ef6d091c60069db686d49ccc89ef"></a><a href="#" name="12"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c22 c13"><p class="c3"><span class="c12">&nbsp;</span><span class="c1">$ sudo prebuilt/linux-x86/fsl/fsl-sdcard-partition.sh /dev/sdX</span></p></td></tr></tbody></table><p class="c3 c19"><span class="c46"></span></p><p class="c3"><span>NOTE: </span></p><ol class="c44" start="1"><li class="c3 c16"><span>The minimum size of SD card is 2G bytes</span></li><li class="c3 c16"><span>/dev/sdxN, the x is the disk index from &#39;a&#39; to &#39;z&#39;, that may be different on each Linux PC.</span></li></ol><p class="c3 c19"><span class="c42 c70"></span></p><h3 class="c20"><a name="h.e7ewd27hrybo"></a><span>3.1.2 Download Images with MFG Tool</span></h3><p class="c3"><span>MFGTool can be used to download all the images into target device. It&rsquo;s a quick and easy tool to download images. </span><span>Please reference &ldquo;</span><span class="c11">Quick Start</span><span>&rdquo; document for detailed operation of MFGTool to download this release image.</span></p><p class="c3 c19"><span></span></p><p class="c3"><span>Please choose one of the downloading profiles by following the table below:</span></p><p class="c3 c19"><span></span></p><p class="c3 c19"><span class="c11"></span></p><a href="#" name="e2786cdb47d8f30763d53cd105847d1128edda64"></a><a href="#" name="13"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr><td class="c54"><p class="c3"><span class="c11">Board Name</span></p></td><td class="c54"><p class="c3"><span class="c11">MFGTool Profile</span></p></td></tr><tr><td class="c54"><p class="c3"><span>MX6DL SaberSD</span></p></td><td class="c54"><p class="c3"><span>Android-SabreSD-eMMC</span></p></td></tr><tr><td class="c54"><p class="c3"><span>MX6Q SabreSD</span></p></td><td class="c54"><p class="c3"><span>Android-SabreSD-eMMC</span></p></td></tr></tbody></table><p class="c3 c10"><span class="c11">Board and MFGTool profile mapping Table</span></p><p class="c3 c19"><span class="c11"></span></p><p class="c3 c19"><span class="c11"></span></p><h3 class="c17 c20"><a name="h.5ld6crm1mpu6"></a><span>3.1.3 Download Images with dd utility</span></h3><p class="c3 c17"><span>The linux utility &quot;dd&quot; on Linux PC can be used to download the images into the MMC/SD/TF card. Before downloading, make sure your MMC/SD/TF card partitions are created as described in section 3.1.1.</span></p><p class="c3"><span>All partitions can be recognized by Linux PC. To download all images into the card, please use the commands below:</span></p><p class="c3 c19"><span class="c12"></span></p><a href="#" name="da01306b92894db94ff2a3ef62a22945953ecd61"></a><a href="#" name="14"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr><td class="c22 c13"><p class="c3"><span class="c1">Download the uboot image:</span></p><p class="c3"><span class="c1"># sudo dd if=u-boot.bin of=/dev/sdx bs=1K skip=1 seek=1; sync</span></p><p class="c3"><span class="c1">Or If you&#39;re using no padding uboot image:</span></p><p class="c3"><span class="c1"># sudo dd if=u-boot-no-padding.bin of=/dev/sdx bs=1K seek=1; sync</span></p><p class="c3"><span class="c1">Download the boot image:</span></p><p class="c3"><span class="c1"># sudo dd if=boot.img of=/dev/sdx1; sync</span></p><p class="c3"><span class="c1">Download the android system root image:</span></p><p class="c3"><span class="c1"># sudo dd if=system.img of=/dev/sdx5; sync</span></p><p class="c3"><span class="c1">Download the android recovery image:</span></p><p class="c3"><span class="c1"># sudo dd if=recovery.img of=/dev/sdx2; sync</span></p></td></tr></tbody></table><p class="c3 c19"><span class="c46"></span></p><p class="c3 c19"><span class="c46"></span></p><h2 class="c29 c31"><a name="h.3db716197dfd"></a><span>3.2 System on NFS</span></h2><p class="c29"><span>Android support runs the system on NFS root filesystem. We can put the total android root system into NFS, and we can load kernel image from TFTP server.</span></p><p class="c3"><span>Y</span><span>ou must have a PC which has NFS and TFTP server, with their root directory setup correctly, e.g /opt/tftproot for TFTP root, and /opt/nfsroot for NFS root.&nbsp;&nbsp;</span></p><h3 class="c20"><a name="h.j4tyo9h2u8of"></a><span>3.2.1 Setup the TFTP and NFS root</span></h3><p class="c3 c19"><span></span></p><p class="c3"><span>After you setup the TFTP/NFS server, please put the kernel image into the tftp server root directory and the Android file system files into the NFS server root directory.</span></p><p class="c3"><span>&nbsp;</span></p><p class="c3"><span>For kernel image, use uImage instead of zImage&nbsp;</span></p><ol class="c44" start="1"><li class="c3 c16"><span>If you are using a prebuilt image, make sure you pick up the correct uImage (see &quot;Prebuilt image for using uboot&quot;)</span></li><li class="c3 c16"><span>If you are building your own image, make sure you generated a uImage (see &quot;Generate uImage to be loaded by u-boot&quot;).</span></li></ol><p class="c3 c19"><span></span></p><p class="c3"><span>Copy uImage to the TFTP server root directory. For example:</span></p><a href="#" name="66b3b3ea764f9d4136137fc059759a5b16268f8b"></a><a href="#" name="15"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c13 c30"><p class="c3"><span class="c1">$ cp your_uImage /opt/tftproot/</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3"><span>Setup the Android file system: </span><span>(take SabreSD as example)</span></p><p class="c3 c19"><span></span></p><ol class="c44" start="1"><li class="c3 c16"><span>If you are using a prebuilt image, unzip the android zip file (see &quot;Prebuilt image for using uboot&quot;) to the NFS server root. For example:</span></li></ol><a href="#" name="ebb48d828e745bdc667c3e5d984e77df645e868e"></a><a href="#" name="16"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">$ cd /opt/imx-android-r13.3/image/sabresd_6q/NFS</span></p><p class="c3"><span class="c1">$ tar xzvf ./android_fs.tar.gz</span></p><p class="c3"><span class="c1">$ cd android_fs</span></p><p class="c3"><span class="c1">$ rm -rf /opt/nfsroot/*</span></p><p class="c3"><span class="c1">$ cp -r * /opt/nfsroot/*</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><ol class="c44" start="1"><li class="c3 c16"><span>If you built out your own Android image, copy the generated Android files to the NFS root manually. For example:</span></li></ol><a href="#" name="793ab2ff57e9236b9833bbabc3951e33d24e7873"></a><a href="#" name="17"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">$ cd myandroid</span></p><p class="c3"><span class="c1">$ rm -rf /opt/nfsroot/*</span></p><p class="c3"><span class="c1">$ cp -r out/target/product/sabresd_6q/root/* /opt/nfsroot/</span></p><p class="c3"><span class="c1">$ cp -r out/target/product/sabresd_6q/system/* /opt/nfsroot/system/&nbsp;</span></p></td></tr></tbody></table><p class="c3 c56 c57"><span class="c11">NOTE:</span><span>&nbsp;Since the NFS uses system and cache folder under /opt/nfsroot/, comment out the mount system and cache lines in /opt/nfsroot/init.rc.</span></p><p class="c3 c56 c57 c19"><span></span></p><p class="c3 c56 c57 c19"><span></span></p><h1 class="c29 c73"><a name="h.q28ksz5s8d8c"></a><span>4. Bootup</span></h1><h2 class="c23"><a name="h.f5orimm44ev2"></a><span>4.1</span><span>&nbsp;Boot from MMC/SD</span></h2><p class="c3 c19"><span class="c62"></span></p><ol class="c44" start="1"><li class="c3 c16"><span class="c11">i.MX6Q and DL </span><span class="c11">SabreSD platform: boot from eMMC</span></li></ol><p class="c3 c19"><span></span></p><p class="c3 c56"><span>Boot Switch:</span></p><p class="c3 c19"><span></span></p><a href="#" name="c53e7b2b2cc695e38a8971b1d7a1b9c8bd60f30b"></a><a href="#" name="18"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr><td class="c26"><p class="c3"><span>download Mode(MFGTool mode)</span></p></td><td class="c68"><p class="c3 c56"><span>(SW6) 00001100 (from 1-8 bit)</span></p></td></tr><tr><td class="c26"><p class="c3"><span>eMMC(MMC4) boot</span></p></td><td class="c68"><p class="c3 c56"><span>(SW6) 11100110 (from 1-8 bit)</span></p></td></tr><tr><td class="c26"><p class="c3"><span>MMC2 boot</span></p></td><td class="c68"><p class="c3 c56"><span>(SW6) 10000010 (from 1-8 bit)</span></p></td></tr><tr><td class="c26"><p class="c3"><span>MMC3 boot</span></p></td><td class="c68"><p class="c3"><span>(SW6) 01000010 (from 1-8 bit)</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3 c19"><span></span></p><p class="c3"><span>If you want to use default env in boot.img, you can use the following command</span></p><p class="c3 c19"><span></span></p><a href="#" name="cbe234ac003c6f251552d575fb4386cf3473ebd1"></a><a href="#" name="19"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr><td class="c13 c41"><p class="c3"><span class="c1">U-Boot &gt; setenv bootargs</span></p></td></tr></tbody></table><p class="c3 c49 c19"><span class="c6 c1"></span></p><p class="c3"><span>to clear the bootargs env.</span></p><p class="c3 c19"><span class="c12"></span></p><a href="#" name="db5374214d689fc97f7810746393f58240200711"></a><a href="#" name="20"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c22 c13"><p class="c3"><span class="c1">U-Boot &gt; setenv bootcmd &lsquo;booti mmc1&rsquo;</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv bootargs console=ttymxc0,115200 init=/init rw &nbsp;video=mxcfb0 fbmem=10M vmalloc=400M androidboot.console=ttymxc0 #[Optional]</span></p><p class="c29 c31 c51"><span class="c1">U-Boot &gt; saveenv &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [Save the environments]</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3"><span class="c11">Note:</span></p><p class="c3"><span>- bootargs env is an optional setting for booti. The boot.img includes a default bootargs, which will be used if there is no definition about the bootargs env.</span></p><p class="c3"><span>- Some SoCs on sabreSD boards do not have MAC address fused, so:</span></p><p class="c3"><span>if you want to use FEC in uboot, please set the following environment:</span></p><p class="c3 c19"><span class="c12"></span></p><a href="#" name="ffb16cda92c4c57fde21e851ccd9b4757c6ac7c2"></a><a href="#" name="21"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c22 c13"><p class="c3"><span class="c1">U-Boot &gt; setenv ethaddr 00:04:9f:00:ea:d3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;[setup the MAC address]</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv fec_addr 00:04:9f:00:ea:d3 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [setup the MAC address] &nbsp; &nbsp;</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3"><span>if you want to use FEC after boot from eMMC/SD card, you must pass a MAC address to kernel as follows:</span></p><a href="#" name="1debc0bbdd3769f00f39eaa74fc2dae75b7058ff"></a><a href="#" name="22"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c13 c22"><p class="c3"><span class="c1">U-Boot &gt; setenv bootargs console=ttymxc1,115200 init=/init rw &nbsp;video=mxcfb0 fbmem=10M vmalloc=400M </span><span class="c1 c11">fec_mac=00:04:9f:00:ea:d3</span></p></td></tr></tbody></table><p class="c3"><span>&nbsp;</span></p><h2 class="c29 c77"><a name="h.r34df2lwgb4i"></a><span>4.</span><span>2 Boot from TFTP and NFS</span></h2><p class="c3"><span>Setup the u-boot environment for loading kernel from TFTP and mounting NFS as root filesystem after the u-boot shell:</span></p><p class="c3 c19"><span class="c11"></span></p><ol class="c44" start="1"><li class="c3 c16"><span class="c11">SabreSD platform</span></li></ol><p class="c3 c19"><span></span></p><a href="#" name="38f2d330fc2c3e784b98c373c9e3dd5889711e7d"></a><a href="#" name="23"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c30 c13"><p class="c3"><span class="c1">U-Boot &gt; setenv loadaddr 0x10800000</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv bootfile uImage</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv serverip &lt;your server ip&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Your TFTP/NFS server ip]</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv nfsroot &lt;your rootfs&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [Your rootfs]</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv bootcmd &#39;dhcp;bootm&#39; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [load kernel from TFTP and boot]</span></p><p class="c3"><span class="c1">U-Boot &gt; setenv bootargs console=ttymxc0,115200 init=/init rw video=mxcfb0 ip=dhcp fbmem=10M nfsroot=${serverip}:/${nfsroot} vmalloc=400M androidboot.console=ttymxc0</span></p><p class="c3"><span class="c1">U-Boot &gt; saveenv&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [Save the environments]</span></p><p class="c3 c19"><span class="c1"></span></p></td></tr></tbody></table><p class="c3 c19"><span class="c11"></span></p><p class="c3 c56 c19"><span></span></p><p class="c29 c51 c31"><span>After you have configured these settings, reboot the board, let u-boot run the bootcmd environment to load kernel and run.</span></p><p class="c29"><span>For the first time boot, it takes some time to finish and get to the Android UI.</span></p><p class="c19 c29"><span></span></p><h2 class="c29 c31"><a name="h.08f97735ad8d"></a><span>4</span><span class="c43 c11">.</span><span>3</span><span class="c43 c11">&nbsp;Boot Up configurations</span></h2><p class="c29 c39 c31"><span>This section explains the common u-boot environments we used for NFS, MMC/SD boot above, and also kernel command line we may have changed for different usage scenarios.</span></p><h3 class="c29 c31"><a name="h.88ff68d3f7be"></a><span>4.3.1 U-Boot environment</span></h3><ol class="c44" start="1"><li class="c3 c25"><span>ethaddr/fec_addr: MAC address of your board</span></li><li class="c3 c25"><span>serverip: IP address of your TFTP/NFS server</span></li><li class="c3 c25"><span>loadaddr/rd_loadaddr: the kernel/initramfs image load address in memory&nbsp;</span></li></ol><ol class="c44" start="1"><li class="c3 c25"><span>bootfile: the name of image file loaded by &quot;dhcp&quot; command, when you using TFTP to load kernel.</span></li><li class="c3 c25"><span>bootcmd: the first variable to run after uboot boot</span></li><li class="c3 c25"><span>bootargs: the kernel command line, bootloader passed to kernel. Described in 4.3.2 section, bootargs env is a optional for booti, boot.img already has boot args. If you do not define the bootargs env, it will use the default bootargs inside of image. If you have the env, it will be used.</span></li></ol><p class="c3 c55"><span>If you want to use default env in boot.img, you can use </span></p><p class="c3 c49"><span class="c6 c1">&gt; setenv bootargs</span></p><p class="c3 c55"><span>to clear the bootargs env.</span></p><ol class="c44" start="4"><li class="c3 c25"><span>dhcp: get ip address by BOOTP protocol, and load the kernel image ($bootfile env) from TFTP server.</span></li><li class="c3 c25"><span>booti: </span></li></ol><p class="c3"><span>&nbsp; &nbsp; &nbsp; &nbsp; booti command will parser the boot.img &#39;s header to get the zImage, and ramdisk, also will pass the bootargs as needed (it will only pass bootargs in boot.img when it can&#39;t find &quot;bootargs&quot; var in your uboot env). To boot from mmcX, you only need to do the following:</span></p><p class="c3 c49"><span class="c6 c1">&gt; booti mmcX<br></span></p><p class="c3 c49"><span>to read the boot partition (the partition store boot.img, in this case, mmcblk0p1), the X was the MMC bus number, which is the Hardware MMC bus number, in SABER_SD board, eMMC is mmc3</span></p><p class="c3"><span>or you can add partition ID after mmcX</span></p><p class="c3 c55"><span class="c6 c1">&gt; booti mmcX boot &nbsp; # &nbsp;boot is default<br>&gt; booti mmcX recovery &nbsp;# boot from the recovery partition,<br></span></p><p class="c3"><span>If you have read the boot.img into memory, you can use this command to boot from</span></p><p class="c3 c49"><span class="c1 c6">&gt; booti 0xXXXXXXXX</span></p><p class="c3 c49 c19"><span class="c6 c1"></span></p><ol class="c44" start="6"><li class="c3 c25"><span>bootm: (only work in NFS case) start to run the kernel, for other case, we use booti command.</span></li></ol><p class="c3 c49 c19"><span class="c6 c1"><br></span></p><p class="c3 c19"><span></span></p><h3 class="c29"><a name="h.e7ddf79061b9"></a><span>4</span><span class="c11 c42">.</span><span>3</span><span class="c42 c11">.2 Kernel command line (bootargs)</span></h3><p class="c3"><span>Depending on the different booting/usage scenarios, you may need different kernel boot parameters set for bootargs.</span></p><p class="c3"><span>&nbsp;</span></p><p class="c3 c19"><span></span></p><a href="#" name="60fd3caf3e20556c7f7a60012dca28d5fe656753"></a><a href="#" name="24"></a><table cellpadding="0" cellspacing="0" class="c36"><tbody><tr class="c33"><td class="c45 c13"><p class="c3"><span class="c42">K</span><span class="c11">ernel Parameter</span></p></td><td class="c45 c13"><p class="c3"><span class="c11">Description</span></p></td><td class="c60 c13"><p class="c3"><span class="c11">Typical Value</span></p></td><td class="c13 c21"><p class="c3"><span class="c11">Used When</span></p></td></tr><tr class="c33"><td class="c45 c28"><p class="c3"><span>&nbsp;</span><span>console</span></p></td><td class="c45 c28"><p class="c3"><span>where to output kernel log by printk</span></p></td><td class="c60 c28"><p class="c3"><span>console=ttymxc0</span></p></td><td class="c21 c28"><p class="c3"><span>All case</span></p></td></tr><tr class="c33"><td class="c45 c28"><p class="c3"><span>&nbsp;init</span></p></td><td class="c45 c28"><p class="c3"><span>tell kernel where is the init file</span></p></td><td class="c28 c60"><p class="c3"><span>init=/init</span></p></td><td class="c21 c28"><p class="c3"><span>All case for Android. &quot;init&quot; in Android is located in &quot;/&quot; instead of in &quot;/sbin&quot;</span></p></td></tr><tr class="c33"><td class="c45 c28"><p class="c3"><span>&nbsp;ip</span></p></td><td class="c45 c28"><p class="c3"><span>tell kernel how/whether to get IP address</span></p></td><td class="c60 c28"><p class="c3"><span>ip=none</span></p><p class="c3"><span>or&nbsp;</span></p><p class="c3"><span>ip=dhcp</span></p><p class="c3"><span>or&nbsp;</span></p><p class="c3"><span>ip=static_ip_address</span></p></td><td class="c21 c28"><p class="c3"><span>&quot;ip=dhcp&quot; or &quot;ip=static_ip_address&quot; is mandatory in &quot;boot from TFTP/NFS&quot;</span></p></td></tr><tr class="c33"><td class="c45 c28"><p class="c3"><span>&nbsp;nfsroot</span></p></td><td class="c45 c28"><p class="c3"><span>where is NFS server/directory</span></p></td><td class="c60 c28"><p class="c3"><span>rootfs=ip_address:/opt/nfsroot,v3,tcp</span></p></td><td class="c21 c28"><p class="c3"><span>Used in &quot;boot from tftp/NFS&quot; together with &quot;root=/dev/nfs&quot;</span></p></td></tr><tr class="c33"><td class="c45 c28"><p class="c3"><span>&nbsp;root</span></p></td><td class="c45 c28"><p class="c3"><span>indicate where is the root file system</span></p></td><td class="c60 c28"><p class="c3"><span>root=/dev/nfs</span></p><p class="c3"><span>or</span></p><p class="c3"><span>root=/dev/mmcblk0p2</span></p></td><td class="c21 c28"><p class="c3"><span>Used in &quot;boot from tftp/NFS&quot; (i.e. root=/dev/nfs);</span></p><p class="c3"><span>Used in &quot;boot from SD&quot; (i.e. root=/dev/mmcblk0p2) if no ramdisk is used for root fs</span></p></td></tr><tr class="c33"><td class="c28 c45"><p class="c3"><span>&nbsp;video</span></p></td><td class="c45 c28"><p class="c3"><span>tell kernel/driver which resolution/depth and refresh rate should be used or tell kernel/driver not to register a framebuffer device for a display device.</span></p></td><td class="c60 c28"><p class="c3"><span>video=mxcfb0:dev=ldb,LDB-XGA,if=RGB666,bpp=32</span></p><p class="c3"><span>or</span></p><p class="c3"><span>video=mxcfb1:dev=hdmi,1920x1080M@60,if=RGB24,bpp=32</span></p><p class="c3"><span>or</span></p><p class="c3"><span>video=mxcfb2:off</span></p></td><td class="c21 c28"><p class="c3"><span>To specify a display framebuffer with:</span></p><p class="c3"><span>video=mxcfb&lt;0,1,2&gt;:dev=&lt;ldb,hdmi&gt;,&lt;LDB-XGA,xres x yresM@fps&gt;,if=&lt;RGB666,RGB24&gt;,bpp=&lt;16,32&gt;</span></p><p class="c3"><span>or</span></p><p class="c3"><span>To disable a display device&rsquo;s framebuffer register with:</span></p><p class="c3"><span>video=mxcfb&lt;0,1,2&gt;:off</span></p><p class="c3 c19"><span></span></p></td></tr><tr><td class="c15"><p class="c3"><span>fbmem</span></p></td><td class="c15"><p class="c3"><span>framebuffer reservation size &nbsp;configure</span></p></td><td class="c66"><p class="c3"><span>fbmem=5M,10M</span></p></td><td class="c35"><p class="c3"><span>fbmem=&lt;fb0 size&gt;,&lt;fb2 size&gt;,&lt;fb4 size&gt;,&lt;fb5 size&gt;</span></p></td></tr><tr><td class="c15"><p class="c3"><span>vmalloc</span></p></td><td class="c15"><p class="c3"><span>vmalloc virtual range size for kernel</span></p></td><td class="c66"><p class="c3"><span>vmalloc=400M</span></p></td><td class="c35"><p class="c3"><span>vmalloc=&lt;size&gt;</span></p></td></tr><tr><td class="c15"><p class="c3"><span>enable_wait_mode</span></p></td><td class="c15"><p class="c3"><span>Enable the i.MX6 WAIT mode. </span></p></td><td class="c66"><p class="c3"><span>enable_wait_mode=off</span></p></td><td class="c35"><p class="c3"><span>enable_wait_mode=&lt;on/off&gt;</span></p></td></tr><tr><td class="c15"><p class="c3"><span>arm_freq</span></p></td><td class="c15"><p class="c3"><span>let cpu wor</span><span>k at</span><span>&nbsp;special frequency(MHz)</span></p></td><td class="c66"><p class="c3"><span>arm_freq=800</span></p></td><td class="c35"><p class="c3"><span>Just for those boards don&rsquo;t rework for 1GHz</span></p></td></tr><tr><td class="c15"><p class="c3"><span>androidboot.console</span></p></td><td class="c15"><p class="c3"><span>The android shell console, should be same as console=</span></p></td><td class="c66"><p class="c3"><span>androidboot.console=ttymxc0</span></p></td><td class="c35"><p class="c3"><span>If you want to use the default shell&rsquo;s job control, like Ctrl-C to terminate a running process, you must set set this for kernel.</span></p></td></tr><tr><td class="c15"><p class="c3"><span>fec_mac</span></p></td><td class="c15"><p class="c3"><span>Setup the FEC mac address</span></p></td><td class="c66"><p class="c3"><span>fec_mac=</span><span>00:04:9f:00:ea:d3</span></p></td><td class="c35"><p class="c3"><span>On SabreSD board, the SoC does not have MAC address fused in, so if you want to use FEC, please assign this parameter to kernel.</span></p></td></tr></tbody></table><p class="c3 c19"><span></span></p><p class="c3 c19"><span class="c11"></span></p><div><p class="c3 c17 c10"><span class="c59">i.MX Android User Guide, R13.3</span></p><hr><p class="c3 c9"><span class="c59"></span></p><p class="c17 c29 c31 c72"><span class="c59">Freescale semiconductor</span></p></div></body></html>